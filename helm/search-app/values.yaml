application-template:
  name: search-app
  namespace: search-app
  clusterSecretStoreName: cluster-secret-store
  serviceAccount:
    create: true
    name: search-app

  configMaps:
    - name: search-app-config
      data:
        API_ENDPOINT: "http://search-app-backend.search-app.svc.cluster.local:8080"

  deployments:
    - name: search-app-frontend
      image:
        repository: ccrawford4/search-app-frontend
        pullPolicy: IfNotPresent
        tag: "latest"
        port: 3000
      service:
        enabled: true
      container:
        envFrom:
          - configMapRef:
              name: search-app-config
    - name: search-app-backend
      image:
        repository: ccrawford4/searchapi
        pullPolicy: IfNotPresent
        tag: "arm64-v1.0.0"
        port: 8080
      service:
        enabled: true
      container:
        envFrom:
          - configMapRef:
              name: search-app-config
        env:
          - name: MYSQL_USERNAME
            valueFrom:
              secretKeyRef:
                name: search-app-secrets
                key: db-username
          - name: MYSQL_PASSWORD
            valueFrom:
              secretKeyRef:
                name: search-app-secrets
                key: db-password

  secrets:
    - name: search-app-secrets
      targetName: search-app-secrets
      data:
        - secretKey: db-username
          remoteRefKey: search-app-db-username
        - secretKey: db-password
          remoteRefKey: search-app-db-password
